# Эксперименты по сравнению LANET с моделями DNNTSP, SFCNTSP, TCMBN

Для тренировки моделей вбейте в utils/config.json и utils/models_configs.json нужные параметры, и запустите скрипт train.sh из корня директории. Аналогично можно использовать evaluate.sh скрипт.

В эксперименте используются данные в формате из кода модели TCMBN. 

## Добавление новых моделей

1) создайте в папке models папку с названием вашей модели
2) В этой папке обязательно должно быть три файла:
- model_creation.py с функцией create_model
- prepare_dataloader.py с функцией prepare_dataloader
- train_eval_routine.py с функциями train_epoch, eval_epoch, evaluate

Сигнатуры функций(принимаемые аргументы и возвращаемые обьекты должны совпадать с уже готовыми примерами других моделей)

3) В файле models_configs.json добавьте словарь с конфигурацией и нужным датасетом для вашей модели.
В файлах Main.py и evaluate.py конфигурационный файл это обьект под названием opt. 
Он передается во все функции из 3х файлов что были описаны выше. Чтобы получить доступ к какой либо характеристики "конфиг-файла", вы можете это сделать обратившись к атрибуту с таким же названием, например, opt.batch_size

При подгрузке конфиг файла, загружается сначала config.json , затем соответствующий модели и датасету словарь из models_configs.json, если есть конфигурационные параметры с одинаковым названием в config.json и models_configs.json, то будут использованы указанные в models_configs.json. Так, например, можно сохранить спецефичный learning rate для конкретной модели на конкретном датасете.

## Добавление датасетов

Данные хранятся в папке tcmbn_data. Пример предобработки данных можете посмотреть в preprocess.ipynb


## Датасеты
Датасеты используются из статьи TCMBN

Авторы привели следующую ссылку на датасеты: https://drive.google.com/drive/u/0/folders/1qFczWc_sVwOsVIga0oywhnVs2vyqVr5r

## Прочие директории
в папку saved_models сохраняются сериализованные обьекты моделей после обучения




