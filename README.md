# Эксперименты по сравнению LANET с моделями DNNTSP, SFCNTSP, TCMBN

Для тренировки моделей вбейте в utils/config.json и utils/models_configs.json нужные параметры, и запустите скрипт train.sh из корня директории. Аналогично можно использовать evaluate.sh скрипт.

Если вы хотите сразу обучить несколько моделей, или сделать это с разными сидами, в поля "seed", "model_name", "dataset_name" можно передать список со значениями вместо значений. Тогда каждая модель будет обучена на каждом датасесете, указанном в списке с названиями датасетом, и с сидами указанными в списке сидов. 

В эксперименте используются данные в формате из кода модели TCMBN. 

После каждого запуска train.sh and evaluate.sh конфигурация добавляются в конец файла utils/history.txt

## Добавление новых моделей

1) создайте в папке models папку с названием вашей модели
2) В этой папке обязательно должно быть три файла:
- model_creation.py с функцией create_model
- prepare_dataloader.py с функцией prepare_dataloader
- train_eval_routine.py с функциями train_epoch, eval_epoch, evaluate

Сигнатуры функций(принимаемые аргументы и возвращаемые обьекты) должны совпадать с уже готовыми примерами других моделей

Обратите внимание, на функцию evaluate. Она должна сохранить confidence scores и ground truth метки с помощью функции save_to_csv. Примеры формата можно посмотреть в коде других моделей в файле train_eval_routine.py

3) В файле models_configs.json добавьте словарь с конфигурацией и нужным датасетом для вашей модели.
В файлах Main.py и evaluate.py конфигурационный файл это обьект под названием opt. 
Он передается во все функции из 3х файлов что были описаны выше. Чтобы получить доступ к какой либо характеристики "конфиг-файла", вы можете это сделать обратившись к атрибуту с таким же названием, например, opt.batch_size

При подгрузке конфиг файла, загружается сначала config.json , затем соответствующий модели и датасету словарь из models_configs.json, если есть конфигурационные параметры с одинаковым названием в config.json и models_configs.json, то будут использованы указанные в models_configs.json. Так, например, можно сохранить спецефичный learning rate для конкретной модели на конкретном датасете.

## Добавление датасетов

Данные хранятся в папке tcmbn_data. Пример предобработки данных можете посмотреть в preprocess.ipynb


## Датасеты
Датасеты используются из статьи TCMBN

Авторы привели следующую ссылку на датасеты: https://drive.google.com/drive/u/0/folders/1qFczWc_sVwOsVIga0oywhnVs2vyqVr5r

## Прочие директории
В папку saved_models сохраняются сериализованные обьекты моделей после обучения
В папку model_pred_and_gt сохраняются предсказания моделей на test и valid сплитах, для дальнейшего анализа другими скриптами.



